% End members are A = Al & B = Ni
% l is the liquid phase
% a is the FCC_A1 (alpha-Al SS) phase
% b is the Al3Ni2 sublattice phase Al3(Ni,Al)2(Va,Ni)1 [y1 = Al, y2 = Va]
% c is Al3Ni phase
% d is BCC_B2 phase
% e is B2_BCC AlNi sublattice phase (Al,Ni)1(Ni,Va)1 [y3 = Al, y4 = Ni]
% Temperature range aA1/lA1/SLb1,2,3,4_1/c1/SLe1,2,3,4_1 T < 700
% Temperature range aA2/lA2/SLb1,2,3,4_2/c2/SLe1,2_2 T < 933.47
% Temperature range aB1/lB1/SLb1,3,4_3/c3/SLe1,2_3 T < 1728
% Temperature range lA3/aA3/SLb1,3,4_4/Slb2_3/c4/SLe1_4;Sle3,4_2 T < 2900

T=1500.0 ;
c=0:0.00002:1.0 ;
N = max(size(c)) ;
for i = 1:N, 
  if (c(i) > 0.5)
    y1(i) = 0.999999 ;
    y2(i) = 0.000001 ;
    y3(i) = 2*(1 - c(i)) ;
    y4(i) = 0.999999 ;
  elseif (c(i) > 0.4)
    y1(i) = 0.999999 ;
    y2(i) = 1-(2 - 5*c(i))/(c(i) - 1) ;
    y3(i) = 0.999999 ;
    y4(i) = c(i)/(1 - c(i)) ;
  else
    y1(i) = 5*c(i)/2 ;
    y2(i) = 0.999999 ;
    y3(i) = 0.999999 ;
    y4(i) = c(i)/(1 - c(i)) ;
  end
end

R=8.31 ;
hlA1=[3028.879  125.251171 -24.3671976 -0.001884662 -8.77664e-7 74092 7.9337e-20 0] ;
hlA2=[-271.21 211.206579 -38.5844296 0.018531982 -5.764227e-06 74092 7.9337e-20 0] ;
hlA3=[-795.996 177.430178 -31.748192 0 0 0 0 0] ;
hlB1=[11235.527 108.457 -22.096 -0.0048047 0 0 -3.82318e-21 0] ;
hlB2=[-9549.817  268.597977 -43.1 0 0 0 0 0] ;
haA1=[-7976.15 137.093038 -24.3671976 -0.001884662 -8.77664e-7 74092.0 0 0] ;
haA2=[-11276.24 223.048446 -38.5844296 0.018531982 -5.764227e-6 74092.0 0 0];
haA3=[-11278.378 188.684153 -31.748192 0 0 0 0 -1.230524e+28] ;
haB1=[-5179.159 117.854 -22.096 -0.0048407 0 0 0 0] ;
haB2=[-27840.62  279.134977 -43.1 0 0 0 0 1.12754e+31] ;
hc1=[-55760.63225  144.5824085 -23.7993982 -0.0026236715 -6.58248e-7  55569 0 0] ;
hc2=[-58235.69975  209.0489645 -34.4623222  0.0126888115 -4.32317025e-6  55569 0 0] ;
hc3=[-58237.30325  183.27574475 -29.335144 -0.001210175 0 0 0 -9.22893e+27] ;
hc4=[-63902.6685  223.595989 -34.586144 0 0 0 0 2.80962107e+30] ;

hslb1_1=[-344333.52  693.758114 -117.2935928 -0.015335386 -2.632992e-6  222276 0 0] ;
hslb1_2=[-354233.79  951.624338 -159.9452888  0.045914546 -1.7292681e-5  222276 0 0] ;
hslb1_3=[-354240.204  848.531459 -139.436576 -0.0096814 0 0 0 -3.691572e+28] ;
hslb1_4=[-399563.126  1171.093413 -181.444576 0 0 0 0 2.251388428e+31] ;
hslb2_1=[40534.25  658.40019 -121.835988 -0.00942331 -4.38832e-6  370460 0 0] ;
hslb2_2=[24033.8  1088.17723 -192.922148  0.09265991 -2.8821135e-5  370460 0 0] ;
hslb2_3=[24023.11  916.355765 -158.74096 0 0 0 0 -6.15262e+28] ;
hslb3_1=[-410263.575  818.951364 -139.3895928 -0.020176086 -2.632992e-6  222276 0 0] ;
hslb3_2=[-420163.845  1076.817588 -182.0412888  0.041073846 -1.7292681e-05  222276 0 0] ;
hslb3_3=[-420170.259  973.724709 -161.532576 -0.0145221 0 0 0 -3.691572e+28] ;
hslb3_4=[-488154.642  1457.56764 -224.544576 0 0 0 0 3.378928428e+31] ;
hslb4_1=[-25395.803  783.59344 -143.931988 -0.01426401 -4.38832e-6  370460 0 0] ;
hslb4_2=[-41896.253  1213.37048 -215.018148  0.08781921 -2.8821135e-05  370460 0 0] ;
hslb4_3=[-41906.943  1041.549015 -180.83696 -0.0048407 0 0 0 -6.15262e+28] ;
hslb4_4=[-64568.404  1202.829992 -201.84096 0 0 0 0 1.121387380e+31] ;

hslb5=[-193484.18  131.79] ;
hslb6=[-22001.7  7.0332] ;

hsle1_1=[-146754.525  272.983788 -46.4631976 -0.006725362 -8.77664e-7  74092 0 0] ;
hsle1_2=[-150054.615  358.939196 -60.6804296  0.013691282 -5.764227e-6 74092 0 0] ;
hsle1_3=[-150056.753  324.574903 -53.8441920 -0.004840700  0  0  0 -1.230524e+28] ;
hsle1_4=[-172718.214  485.855880 -74.8481920  0  0  0  0  1.126309476e+31] ;
hsle2_1=[12106.85  131.280038 -24.3671976 -0.001884662 -8.776640e-7  74092 0 0] ;
hsle2_2=[8806.760  217.235446 -38.5844296  0.018531982 -5.764227e-6  74092 0 0] ;
hsle2_3=[8804.622  182.871153 -31.7481920  0  0  0  0 -1.230524e+28] ;
hsle3_1=[7071.850  228.596000 -44.1920000 -0.0096814 0 0 0 0] ;
hsle3_2=[-38251.072  551.157954 -86.2  0  0  0  0  2.25508e+31] ;
hsle4_1=[165933.225  86.89225 -22.096 -0.0048407 0 0 0 0] ;
hsle4_2=[143271.764  248.173227 -43.10  0  0  0  0  1.12754e+31] ;

hsle5=[-64024.38  26.49419] ;
hsle6=[-52440.88  11.30117] ;

co=0.25 ;
ct=0.05 ;

if (T > 1728.0)
  hlA=hlA3 ;
  hlB=hlB2 ;
  haA=haA3 ;
  haB=haB2 ;
  hslb1=hslb1_4 ;
  hslb2=hslb2_3 ;
  hslb3=hslb3_4 ;
  hslb4=hslb4_4 ;
  hc=hc4 ;
  hsle1=hsle1_4 ;
  hsle2=hsle2_3 ;
  hsle3=hsle3_2 ;
  hsle4=hsle4_2 ;
elseif (T > 933.47)
  hlA=hlA3 ;
  hlB=hlB1 ;
  haA=haA3 ;
  haB=haB1 ;
  hslb1=hslb1_3 ;
  hslb2=hslb2_3 ;
  hslb3=hslb3_3 ;
  hslb4=hslb4_3 ;
  hc=hc3 ;
  hsle1=hsle1_3 ;
  hsle2=hsle2_3 ;
  hsle3=hsle3_1 ;
  hsle4=hsle4_1 ;
elseif (T > 700.0)
  hlA=hlA2 ;
  hlB=hlB1 ;
  haA=haA2 ;
  haB=haB1 ;
  hslb1=hslb1_2 ;
  hslb2=hslb2_2 ;
  hslb3=hslb3_2 ;
  hslb4=hslb4_2 ;
  hc=hc2 ;
  hsle1=hsle1_2 ;
  hsle2=hsle2_2 ;
  hsle3=hsle3_1 ;
  hsle4=hsle4_1 ;
else
  hlA=hlA1 ;
  hlB=hlB1 ;
  haA=haA1 ;
  haB=haB1 ;
  hslb1=hslb1_1 ;
  hslb2=hslb2_1 ;
  hslb3=hslb3_1 ;
  hslb4=hslb4_1 ;
  hc=hc1 ;
  hsle1=hsle1_1 ;
  hsle2=hsle2_1 ;
  hsle3=hsle3_1 ;
  hsle4=hsle4_1 ;
end

hdA=haA+[10083.0 -4.813 0 0 0 0 0 0] ;
hdB=haB+[8715.084 -3.556 0 0 0 0 0 0] ;

hrkl0=[-207109.28 41.31501] ;
hrkl1=[-10185.79 5.8714] ;
hrkl2=[81204.81 -31.95713] ;
hrkl3=[4365.35 -2.51632] ;
hrkl4=[-22101.64 13.16341] ;

hrka0=[-162407.75 16.212965] ;
hrka1=[73417.798 -34.914168] ;
hrka2=[33471.014 -9.8373558] ;
hrka3=[-30758.01 10.25267] ;

glA=hlA(1)+hlA(2)*T+hlA(3)*T*log(T)+hlA(4)*T^2+hlA(5)*T^3+hlA(6)/T+hlA(7)*T^7+hlA(8)/T^9 ;
glB=hlB(1)+hlB(2)*T+hlB(3)*T*log(T)+hlB(4)*T^2+hlB(5)*T^3+hlB(6)/T+hlB(7)*T^7+hlB(8)/T^9 ;
gaA=haA(1)+haA(2)*T+haA(3)*T*log(T)+haA(4)*T^2+haA(5)*T^3+haA(6)/T+haA(7)*T^7+haA(8)/T^9 ;
gaB=haB(1)+haB(2)*T+haB(3)*T*log(T)+haB(4)*T^2+haB(5)*T^3+haB(6)/T+haB(7)*T^7+haB(8)/T^9 ;
gc0=hc(1)+hc(2)*T+hc(3)*T*log(T)+hc(4)*T^2+hc(5)*T^3+hc(6)/T+hc(7)*T^7+hc(8)/T^9 ;

RKl0=(hrkl0(1)+hrkl0(2)*T) ;
RKl1=(hrkl1(1)+hrkl1(2)*T).*(1-2*c) ;
RKl2=(hrkl2(1)+hrkl2(2)*T).*(1-2*c).^2 ;
RKl3=(hrkl3(1)+hrkl3(2)*T).*(1-2*c).^3 ;
RKl4=(hrkl4(1)+hrkl4(2)*T).*(1-2*c).^4 ;

RKl=c.*(1-c).*(RKl0+RKl1+RKl2+RKl3+RKl4);

RKa0=(hrka0(1)+hrka0(2)*T) ;
RKa1=(hrka1(1)+hrka1(2)*T).*(1-2*c) ;
RKa2=(hrka2(1)+hrka2(2)*T).*(1-2*c).^2 ;
RKa3=(hrka3(1)+hrka3(2)*T).*(1-2*c).^3 ;

RKa=c.*(1-c).*(RKa0+RKa1+RKa2+RKa3) ;

SLb1=hslb1(1)+hslb1(2)*T+hslb1(3)*T*log(T)+hslb1(4)*T^2+hslb1(5)*T^3+hslb1(6)/T+hslb1(7)*T^7+hslb1(8)/T^9 ;
SLb2=hslb2(1)+hslb2(2)*T+hslb2(3)*T*log(T)+hslb2(4)*T^2+hslb2(5)*T^3+hslb2(6)/T+hslb2(7)*T^7+hslb2(8)/T^9 ;
SLb3=hslb3(1)+hslb3(2)*T+hslb3(3)*T*log(T)+hslb3(4)*T^2+hslb3(5)*T^3+hslb3(6)/T+hslb3(7)*T^7+hslb3(8)/T^9 ;
SLb4=hslb4(1)+hslb4(2)*T+hslb4(3)*T*log(T)+hslb4(4)*T^2+hslb4(5)*T^3+hslb4(6)/T+hslb4(7)*T^7+hslb4(8)/T^9 ;

SLb5=hslb5(1)+hslb5(2)*T ;
SLb6=hslb6(1)+hslb6(2)*T ;

SLb1=SLb1/6 ;
SLb2=SLb2/6 ;
SLb3=SLb3/6 ;
SLb4=SLb4/6 ;
SLb5=SLb5/6 ;
SLb6=SLb6/6 ;

SLe1=hsle1(1)+hsle1(2)*T+hsle1(3)*T*log(T)+hsle1(4)*T^2+hsle1(5)*T^3+hsle1(6)/T+hsle1(7)*T^7+hsle1(8)/T^9 ;
SLe2=hsle2(1)+hsle2(2)*T+hsle2(3)*T*log(T)+hsle2(4)*T^2+hsle2(5)*T^3+hsle2(6)/T+hsle2(7)*T^7+hsle2(8)/T^9 ;
SLe3=hsle3(1)+hsle3(2)*T+hsle3(3)*T*log(T)+hsle3(4)*T^2+hsle3(5)*T^3+hsle3(6)/T+hsle3(7)*T^7+hsle3(8)/T^9 ;
SLe4=hsle4(1)+hsle4(2)*T+hsle4(3)*T*log(T)+hsle4(4)*T^2+hsle4(5)*T^3+hsle4(6)/T+hsle4(7)*T^7+hsle4(8)/T^9 ;

SLe5=hsle5(1)+hsle5(2)*T ;
SLe6=hsle6(1)+hsle6(2)*T ;

%SLe1=SLe1/2 ;
%SLe2=SLe2/2 ;
%SLe3=SLe3/2 ;
%SLe4=SLe4/2 ;
%SLe5=SLe5/2 ;
%SLe6=SLe6/2 ;

ent=R*T*(c.*log(c)+(1-c).*log(1-c)) ;
entSLb=R*T*((y1.*log(y1)+(1-y1).*log(1-y1))/3 + (y2.*log(y2)+(1-y2).*log(1-y2))/6) ;
entSLe=R*T*((y3.*log(y3)+(1-y3).*log(1-y3)) + (y4.*log(y4)+(1-y4).*log(1-y4))) ;

gl=glA*(1-c)+glB*c+ent+RKl ;
ga=gaA*(1-c)+gaB*c+ent+RKa ;

gb0=gaA*(1-c)+gaB*c ;

gb1=SLb1*(y1.*y2)+SLb2*((1-y1).*y2)+SLb3*(y1.*(1-y2))+SLb4*((1-y1).*(1-y2)) ;
gb2=SLb5*(y1.*(1-y1)) + SLb6*(y2.*(1-y2)) ;

ge1=SLe1*(y3.*y4)+SLe2*(y3.*(1-y4))+SLe3*((1-y3).*y4)+SLe4*((1-y3).*(1-y4)) ;
ge2=SLe6*(y3.*(1-y3)) + SLe5*(y4.*(1-y4)) ;

gb=(gb1+gb2+entSLb)./(1-y2/6) ;
ge=(ge1+ge2+entSLe)./(1.0+y4) ;

% gc=(gc0).*exp(-(((c-co)/ct).^2));
% gc=(gc0+ent).*exp(-(((c-co)/ct).^2)) ;

plot(c,gl,'b')
hold on
plot(c,ga,'r')
plot(c(1:(N-1)/2),gb(1:(N-1)/2),'g')
plot(c,ge,'m')

% plot(c,gc,'m')
